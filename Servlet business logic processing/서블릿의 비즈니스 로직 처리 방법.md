# 서블릿의 비즈니스 로직 처리 방법
웹 프로그램은 클라이언트의 요청에 대해서 비즈니스 처리 기능을 이용해 데이터 저장소에서 데이터를 조회한 후 서블릿의 응답 기능을 이용해 클라이언트에게 결과를 전송  
예시로 온라인 서점에서 책 제목을 검색창에 입력하고 검색 버튼을 누르면 책 제목이 서블릿으로 전송됨. 서블릿은 책 제목을 전송 받아 책 제목에 대한 정보를 데이터베이스 연동 기능을 이용해 조회, 조회한 결과를 서블릿 응답 기능을 이용해 클라이언트 브라우저에 전송하여 결과를 보여줌.

**서블릿 비즈니스 처리 작업**이란 서블릿이 클라이언트로부터 요청을 받으면 그 요청에 대해 작업을 수행하는 것을 의미. 웹 프로그램에서 대부분의 비즈니스 처리 작업은 데이터베이스 연동 관련 작업이지만 그 외에 다른 서버와 연동해서 데이터를 얻는 작업도 수행. 서블릿의 핵심 기능이라 할 수 있을 만큼 중요.

대표적인 예시  
* 웹 사이트 회원 등록 요청 처리 작업
* 웹 사이트 로그인 요청 처리 작업
* 쇼핑몰 상품 주문 처리 작업

## 서블릿의 데이터베이스 연동
데이터베이스와 연동하여 조회한 데이터를 얻은 후 클라이언트의 웹 브라우저로 응답하는 과정.
서블릿에서 데이터베이스와 연동하는 과정은 자바의 데이터베이스 연동 과정과 같음.
서블릿은 SQL문을 사용해 데이터베이스에 접근. 이 과정에서 DAO와 VO클래스가 사용됨.
### 회원정보 테이블의 회원정보 조회
각 클래스가 연동해서 데이터베이스에 접근. 서블릿에서 회원 정보 조회 후, 다시 HTML로 만들어 웹 브라우저로 전송해 출력.
1. 웹 브라우저가 서블릿에게 회원 정보를 요청
2. MemberServlet은 요청을 받은 후 MemberDAO 객체를 생성하여 listMembers() 메서드를 호출
3. listMembers()에서 다시 connDB() 메서드를 호출하여 데이터베이스와 연결한 후 SQL문을 실행해 회원 정보를 조회.
4. 조회된 회원 정보를 MemberVO 속성에 설정한 후 다시 ArrayList에 저장
5. ArrayList를 다시 메서드를 호출한 MemberServlet으로 반환한 후 ArrayList의 MemberVO를 차례대로 가져와 회원 정보를 HTML 태그의 문자열로 만듬.
6. 만들어진 HTML 태그를 웹 브라우저로 전송해서 회원 정보를 출력.

* 회원 정보 테이블 생성 후, 회원 정보를 추가하여 웹 브라우저에서 서블릿으로 요청하면 데이터베이스(회원테이블)과 연동해 회원 정보를 웹 브라우저로 출력하는 작업

1. SQL Developer에서 회원테이블과 회원정보를 입력하기 위해 SQL Developer를 실행
2. 왼쪽 메뉴에 +를 클릭 후 새 접속... 을 선택
3. 미리 만들어 놓은 접속 이름을 클릭하거나 직접 연결 정보를 입력한 후 접속을 클릭
4. 워크시트에 테이블 생성 SQL문 입력
5. SQL문 실행, 테이블 생성. insert문에도 동일 작업.
6. 커밋 완료후 select문으로 조회 시 회원 정보 표시
7. 이클립스에서 새 프로젝트 생성 후 오라클 데이터베이스와 연동하는 데 필요한 드라이버인 ojdbc6.jar를 프로젝트의 /WebContent/WEB-INF/lib 폴더에 복사하여 붙여넣기.
> https://www.oracle.com/technetwork/apps-tech/jdbc-112010-090769.html 에서 오라클 드라이버 다운 가능.

8. sec01.ex01 패키지를 만들고 회원 조회와 관련된 자바 클래스 파일인 MemberDAO, MemberServlet, MemberVO 클래스 각각 생성
9. 브라우저의 요청을 받는 MemberServlet 클래스 작성.
```
MemberDAO dao = new MemberDAO();  //SQL문으로 조회할 MemberDAO 객체 생성
List<MemberVO> list = dao.listMembers();  //listMembers() 메서드로 회원 정보를 조회

out.print("<html><body>");
out.print("<table border=1><tr align='center' bgcolor='lightgreen'>");
out.print("<td>아이디</td><td>비밀번호</td><td>이름</td><td>이메일</td><td>가입일</td></tr>");
for(int i = 0; i < list.size(); i++){
  MemberVO memberVO = list.get(i);
  String id = memberVO.getId();
  String pwd = memberVO.getPwd();
  String name = memberVO.getName();
  String email = memberVO.getEmail();
  Date joinDate = memberVO.getJoinDate();
  out.print("<tr><td>" + id + "</td><td>" + pwd + "</td><td>" + name + "</td><td>" + email + "</td><td>" + joinDate + "</td></tr>");
}
out.print("</table></body></html>");
}
}
```

10. MemberDAO 클래스 작성. 회원 정보 조회 SQL문을 실행하여 조회한 레코드들의 컬럼 값을 다시 MemberVO 객체의 속성에 설정한 다음 ArrayList에 저장하고 호출한 곳으로 반환
```

```

11. MemberVO 클래스 작성. 값을 전달하는 데 사용되는 VO(Value Object)클래스. 테이블에서 조회한 레코드의 컬럼 값을 속성에 저장해야 하므로 컬럼 이름과 동일한 자료형과 이름으로 속성을 선언하고 getter/setter를 각각 생성.
```

```

12. 웹 페이지로 요청하고 실행 결과 확인. 회원 정보가 웹 브라우저로 출력되는 것을 확인.
